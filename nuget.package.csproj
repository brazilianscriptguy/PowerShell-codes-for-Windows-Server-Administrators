<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <!-- Target Framework -->
    <TargetFramework>net7.0</TargetFramework>

    <!-- Package Metadata -->
    <PackageId>Scripts-PowerShell</PackageId>
    <Authors>Luiz Hamilton Silva</Authors>
    <Company>Brazilianscriptguy</Company>
    <Product>Scripts-PowerShell</Product>
    <Description>
      Comprehensive suite of PowerShell and VBScript tools automates Active Directory tasks, advances forensic analysis, 
      and simplifies script creation. Designed for managing Windows Servers and workstations, these tools ensure accuracy, 
      efficiency, scalability, and adaptability, optimizing daily operations, performance, and system compliance.
    </Description>
    <PackageTags>PowerShell;Automation;SysAdmin;ActiveDirectory;Forensics</PackageTags>
    <RepositoryUrl>https://github.com/brazilianscriptguy/Windows-SysAdmin-ProSuite</RepositoryUrl>
    <Version Condition="'$(version)' == ''">1.0.0</Version>
    <GenerateAssemblyInfo>false</GenerateAssemblyInfo> <!-- Disable Assembly Info Generation -->
    <NoBuild>true</NoBuild> <!-- Disable Build Requirement -->
    <NoWarn>NU5110;NU5123</NoWarn> <!-- Suppress Warnings -->
  </PropertyGroup>

  <!-- Include necessary files for the NuGet package -->
  <ItemGroup>
    <!-- Include PowerShell scripts -->
    <Content Include="Scripts-PowerShell/**/*.ps1" PackagePath="content/" />
    <!-- Include VBScript files -->
    <Content Include="Scripts-PowerShell/**/*.vbs" PackagePath="content/" Condition="Exists('Scripts-PowerShell/**/*.vbs')" />
    <!-- Include text, HTA, and BGI files -->
    <Content Include="Scripts-PowerShell/**/*.txt" PackagePath="content/" Condition="Exists('Scripts-PowerShell/**/*.txt')" />
    <Content Include="Scripts-PowerShell/**/*.hta" PackagePath="content/" Condition="Exists('Scripts-PowerShell/**/*.hta')" />
    <Content Include="Scripts-PowerShell/**/*.bgi" PackagePath="content/" Condition="Exists('Scripts-PowerShell/**/*.bgi')" />
    <!-- Include LICENSE and README -->
    <Content Include="Scripts-PowerShell/LICENSE" PackagePath="content/" Condition="Exists('Scripts-PowerShell/LICENSE')" />
    <Content Include="Scripts-PowerShell/README.md" PackagePath="content/" Condition="Exists('Scripts-PowerShell/README.md')" />
  </ItemGroup>

  <!-- Exclude problematic folders to address long path warnings -->
  <ItemGroup>
    <Content Include="Scripts-PowerShell/**" Exclude="Scripts-PowerShell/SysAdmin-Tools/GroupPolicyObjects-Templates/**" PackagePath="content/" />
  </ItemGroup>

  <!-- Ensure the scripts are marked as package content -->
  <ItemGroup>
    <None Include="Scripts-PowerShell/**" PackagePath="content/" />
  </ItemGroup>

</Project>
